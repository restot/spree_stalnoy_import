/* xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */
importScripts('<%= s = javascript_url "spree/backend/shim.js"; s[1..-1] %>');

/* uncomment the next line for encoding support */
//importScripts('dist/cpexcel.js');
//importScripts('jszip.js');
//importScripts('xlsx.js');
importScripts('<%= s = javascript_url "spree/backend/dist/cpexcel.js"; s[1..-1]%>');
importScripts('<%= s = javascript_url "spree/backend/jszip.js"; s[1..-1]%>');
importScripts('<%= s = javascript_url "spree/backend/xlsx.js"; s[1..-1]%>');
postMessage({t:"ready"});

onmessage = function (evt) {
  var v;
  try {
    v = XLSX.read(evt.data.d, {type: evt.data.b});
postMessage({t:"xlsx", d:JSON.stringify(v)});
  } catch(e) { postMessage({t:"e",d:e.stack||e}); }
};
<%= "test" %>